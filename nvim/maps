"vim:syntax=vim

set backspace=indent,eol,start
let g:flog_enable=0

nmap fj ]m
nmap fk [m

" Fold ruby methods by default
" let ruby_fold=100
"let g:ruby_fold_lines_limit = 200

" :hi Folded guibg=black ctermfg=white ctermbg=darkgrey

set splitbelow
set splitright

let g:UltiSnipsExpandTrigger="<tab>"
let g:UltiSnipsListSnippets="<c-u>"
let g:UltiSnipsJumpForwardTrigger="<c-n>"
let g:UltiSnipsJumpBackwardTrigger="<c-m>"

let g:UltiSnipsSnippetsDir = "/Users/sanjos/dotfiles/nvim/snips"
let g:UltiSnipsSnippetDirectories=["/Users/sanjos/dotfiles/nvim/snips", "UltiSnips"]
let g:UltiSnipsEditSplit= "context"

let test#ruby#rspec#options = {
  \ 'nearest': '--backtrace',
  \ 'file':    '--format documentation',
  \ 'suite':   '--tag ~slow',
\}

function! SplitStrategy(cmd)
  vsp | e 999 | call termopen(a:cmd)
endfunction
let g:test#custom_strategies = {'terminal_split': function('SplitStrategy')}

let test#ruby#rspec#executable = 'time bundle exec rspec'

let g:test#preserve_screen = 1
let g:test#strategy = 'terminal_split'


nmap ,r :TestNearest<CR>
nmap ,a :TestFile<CR>
nmap ,e :TestLast<CR>
nmap ,tr :call RunRspecForRubyFile()<CR>

" To screw myself up
nmap <up> <nop>
nmap <down> <nop>
nmap <left> <nop>
nmap <right> <nop>

map <C-j> 10j
map <C-k> 10k

nmap <CR> :nohlsearch<CR>
nmap ,, :nohlsearch<CR>

" paste replacing current word"
nmap <silent> cp "_cw<C-R>"<Esc>

" Insert a hash rocket with <c-l>
imap <c-l> <space>=><space>

" To be more natural
"nnoremap j gj
"nnoremap k gk

" nerdTree
map <C-n> :NERDTreeToggle<CR>
map <C-h> :NERDTreeFind<CR>

" Relative number
nnoremap <C-b> :call NumberToggle()<cr>

" Tab to navigate over tabs
map <Tab> <C-W>w

nmap <C-c> :put=expand('%:t:r')<CR>


"fzf
map <C-p> :Files<CR>
map <C-l> :buffers<CR> map <C-o> :Tags<CR>

"To add comments
map ,c :Commentary<CR>

" Save
map ,w :w<CR>

"to replace line with yank
map D "_ddkp"

"to close buffer
map ,q :Bclose<cr>

"to move buffers
map zl :bn<CR>
map zh :bp<CR>

"maximize buffers
map zN <C-W>\|
map zn <C-W>=

"Switch to test files
nmap ,tt :call SwitchRspecOrRuby('', '')<CR>
nmap ,ts :call SwitchRspecOrRuby(":vsp \| ", '')<CR>

nmap ,cr :call CreateRspecFromCurrentFile()<CR>
nmap ,l :call SpringToggle()<CR>

"Search all occurrences
nnoremap <silent> ,ag :Ag <C-R><C-W><CR>

"beutify JSON
map ,bj :<,'>!python -m json.tool<CR>

:set colorcolumn=100

map zp :vsp \| :find ~/Dropbox/Public/TODO<CR><C-W>r:vertical resize -60<CR><C-W>w

nnoremap Q <nop>
nnoremap K <nop>

" neomake
nmap ,nw :lopen<CR>      " open location window

" For global replace
nnoremap gR gD:%s/<C-R>///gc<left><left><left>

" multi cursor
let g:multi_cursor_use_default_mapping=0

"let g:multi_cursor_next_key='<C-]>'
"let g:multi_cursor_prev_key='<C-[>'
"let g:multi_cursor_skip_key='<C-s>'
"let g:multi_cursor_quit_key='<Esc>'
"let g:multi_cursor_start_key='<C-|>'
